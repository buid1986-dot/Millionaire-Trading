name: Ejecutar Script Diario

on:
  schedule:
    - cron: '55 13 * * 1-5'  # 13:55 UTC todos los días (5:55AM TJ)
    - cron: '25 16 * * 1-5'  # 16:25 UTC todos los días (8:25AM TJ)
    - cron: '55 18 * * 1-5'  # 18:55 UTC todos los días (10:55AM TJ)
    - cron: '55 21 * * 1-5'  # 21:55 UTC todos los días (01:55PM TJ)

jobs:
  run-script:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Configurar Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.12'
      - name: Instalar dependencias
        run: pip install yfinance pandas numpy pytz
      - name: Ejecutar el script
        run: |
          echo "=== Resultados MultiCryptoTradingStrategy ===" > output.txt
          python MultiCryptoTradingStrategy_v3.py >> output.txt
          echo "" >> output.txt
          echo "=== Resultados Segundo Script ===" >> output.txt
          python segundo_script.py >> output.txt
      - name: Enviar email con resultados
        uses: dawidd6/action-send-mail@v6  # Usa la versión estable, como v3 o la más reciente (ver docs)
        with:
          server_address: smtp.gmail.com  # Para Gmail; cambia si usas otro servidor
          server_port: 465  # Puerto seguro para Gmail
          secure: true  # Usa conexión segura (SSL)
          username: ${{ secrets.MAIL_USERNAME }}  # Tu email desde secrets
          password: ${{ secrets.MAIL_PASSWORD }}  # Contraseña de app desde secrets
          from: Diego Bustillos <${{ secrets.MAIL_USERNAME }}>  # Remitente
          to: buid.1986@gmail.com  # Email donde recibirás los resultados (puedes poner varios separados por coma)
          subject: Resultados diarios de análisis de trading - ${{ github.job }}  # Asunto dinámico
          body: file://output.txt  # Adjunta el contenido del output como cuerpo de texto plano
